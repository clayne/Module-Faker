#!perl
use v5.36.0;
# PODNAME: module-blaster
# ABSTRACT: create a random distribution

use lib 'lib';

use Data::Fake qw(Core Dates Names Text);
use Getopt::Long::Descriptive;
use List::Util qw(uniq);
use Module::Faker::Dist;

use lib 'nonsense';
use Meta qw(
  fake_cpan_author
  fake_cpan_distribution
  fake_license
  fake_package_names
  fake_version
);

my ($opt, $usage) = describe_options(
  '%c %o',
  [ 'number|n=i', 'how many dists to blast out', { default => 1 } ],
);

for my $n (1 .. $opt->number) {
  my $dist = fake_cpan_distribution()->();
  my $archive = $dist->make_archive({ dir => '.' });
  say "Produced archive as $archive (cpan author: " . $dist->cpan_author . ")";
  say "- $_" for sort map {; $_->name } $dist->packages;
}
